% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funlib.R
\name{ith_pred}
\alias{ith_pred}
\title{Internal: Predict using local PLS coefficients and optional
dissimilarities}
\usage{
ith_pred(plslib, xscale, Xu, xunn, dxrxu = NULL, ...)
}
\arguments{
\item{plslib}{A matrix of PLS model coefficients. First column is the
intercept; remaining columns are coefficients for scaled features.}

\item{xscale}{A matrix of scaling values for each feature (same dimensions
as \code{plslib[,-1]}).}

\item{Xu}{A numeric vector (or single-row matrix) representing the query
sample to be predicted.}

\item{xunn}{Currently unused; placeholder for nearest neighbor indices.}

\item{dxrxu}{Optional numeric vector of dissimilarities between \code{Xu} and
reference samples. If provided, used as additional predictive
features.}

\item{...}{Additional arguments (currently ignored).}
}
\value{
A numeric scalar containing the predicted response for \code{Xu}.
}
\description{
Computes a prediction for a new observation using a local PLS model
represented by coefficients (\code{plslib}). The prediction is based on
inverse-scaled feature values. If a dissimilarity vector is provided, it is
appended to the input features before inverse scaling.
}
\details{
The function constructs a synthetic predictor vector by dividing
\code{xscale} by \code{Xu} (or by the concatenation of \code{dxrxu} and \code{Xu}), then
inverting the result. This reflects a distance- or similarity-based
transformation. The resulting vector is then multiplied element-wise with
the PLS coefficients, and the sum is added to the intercept to compute
the final prediction.
}
\author{
Leonardo Ramirez-Lopez
}
\keyword{internal}
