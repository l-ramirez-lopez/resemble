% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funlib.R
\name{i_nn_stats}
\alias{i_nn_stats}
\title{Quantile Stats of Neighbor Responses}
\usage{
i_nn_stats(..i.., kidxmat, kidxgrop, Yr, k)
}
\arguments{
\item{..i..}{Index of the sample being analyzed.}

\item{kidxmat}{Matrix of nearest neighbor indices (rows = neighbors).}

\item{kidxgrop}{Matrix mask to filter out same-group neighbors (TRUE = keep).}

\item{Yr}{Numeric response vector or 1-col matrix.}

\item{k}{Vector of neighbor counts for each sample.}
}
\value{
A matrix of quantiles (0\%, 5\%, 25\%, 50\%, 75\%, 95\%, 100\%) of the
response values among the valid nearest neighbors.
}
\description{
Computes quantiles of the response values among the filtered
nearest neighbors for a specific sample.
}
\details{
For the i-th sample, this function selects the top-k neighbors for
each sample, filters using the group mask, and computes quantile
statistics from their corresponding response values in \code{Yr}.
}
\author{
Leonardo Ramirez-Lopez
}
\keyword{internal}
