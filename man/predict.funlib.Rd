% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funlib.R
\name{predict.funlib}
\alias{predict.funlib}
\title{Predict from a funlib object}
\usage{
\method{predict}{funlib}(
  object,
  newdata,
  weighting = "triweight",
  range.pred.lim = FALSE,
  local = TRUE,
  diss_method = object$dissimilatity$diss_method
)
}
\arguments{
\item{object}{A fitted object of class \code{"funlib"}, typically created by
a function that builds a local function library.}

\item{newdata}{A data frame or matrix containing new predictor values.
Must include all required predictors used in \code{object}.}

\item{weighting}{Character string specifying the weighting function used
to weight neighbors in the prediction. Options are:
\code{"triweight"} (default), \code{"tricube"}, \code{"triangular"},
\code{"quartic"}, \code{"parabolic"}, or \code{"gaussian"}.}

\item{range.pred.lim}{Logical. If \code{TRUE}, predictions falling outside
the range of the neighborhood will be clipped to the 5–95\% interval
observed in that neighborhood.}
}
\value{
A list with:
\describe{
\item{predictions}{A data frame with the following columns:
\itemize{
\item \code{pred}: predicted values,
\item \code{pred.sd}: weighted standard deviation of predictions,
\item \code{gh}: (if applicable) global heterogeneity dissimilarity score,
\item \code{min.yr.in.neighborhood}: 5th percentile of neighbor targets,
\item \code{max.yr.in.neighborhood}: 95th percentile of neighbor targets,
\item \code{below.lower.lim}, \code{above.upper.lim}: logicals indicating
whether the prediction falls outside these limits.
}}
\item{neighbour.list}{A list with:
\itemize{
\item \code{indices}: indices of the selected neighbors,
\item \code{diss.scores}: their dissimilarity scores.
}}
}
}
\description{
Makes predictions using a local ensemble model from a \code{funlib} object.
Dissimilarity-based neighborhood selection is used for each new sample, and
predictions are made via a weighted combination of local models.
}
\details{
This function uses dissimilarity-based local modeling to compute
ensemble predictions for new data. For each new sample, a neighborhood of
\code{optimalk} samples is selected based on the dissimilarity metric
defined in the \code{funlib} object. The predictions are weighted according
to the selected kernel function.
}
\references{
Cleveland, W. S., & Devlin, S. J. (1988). Locally weighted regression:
An approach to regression analysis by local fitting.
\emph{Journal of the American Statistical Association}, 83(403), 596–610.

Næs, T., & Isaksson, T. (1990). Locally weighted regression and scatter
correction methods in practical spectroscopy. \emph{Applied Spectroscopy},
44(3), 378–383.
}
\author{
Leonardo Ramirez-Lopez
}
